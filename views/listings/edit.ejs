<% layout("/boilerplate.ejs") -%>

<body class="bg-light">

  <div class="container my-5">
    <div class="row justify-content-center">
      <div class="col-md-8 col-lg-6">

        <div class="card shadow-sm border-0">
          <div class="card-body p-4">

            <h3 class="text-center mb-4 fw-semibold" style="color:#FF385C;">
              Edit Listing
            </h3>

            <form 
              method="post" 
              action="/listings/<%= listing._id %>?_method=PUT" 
              enctype="multipart/form-data"
            >

              <div class="mb-4">
                <h6 class="fw-semibold mb-3">Basic Info</h6>

                <div class="mb-3">
                  <label class="form-label">Title</label>
                  <input 
                    type="text"
                    name="title"
                    class="form-control"
                    value="<%= listing.title %>"
                    required
                  >
                </div>

                <div class="mb-3">
                  <label class="form-label">Description</label>
                  <textarea 
                    name="description"
                    class="form-control"
                    rows="4"
                    required
                  ><%= listing.description %></textarea>
                </div>
              </div>

              <div class="mb-4">
                <h6 class="fw-semibold mb-3">Current Image</h6>

                <div class="mb-3">
                  <img 
                    src="<%= originalImageUrl %>" 
                    alt="<%= listing.image.filename %>"
                    class="img-fluid rounded"
                    style="max-height:200px;"
                  >
                </div>

                <input 
                  type="file"
                  name="image"
                  class="form-control"
                >
                <small class="text-muted">
                  Upload a new image only if you want to replace the current one
                </small>
              </div>

              <div class="mb-4">
                <h6 class="fw-semibold mb-3">Pricing & Location</h6>

                <div class="mb-3">
                  <label class="form-label">Price (per night)</label>
                  <input 
                    type="number"
                    name="price"
                    class="form-control"
                    value="<%= listing.price %>"
                    required
                  >
                </div>

                <div class="mb-3">
                  <label class="form-label">Location</label>
                  <input 
                    type="text"
                    name="location"
                    class="form-control"
                    value="<%= listing.location %>"
                    required
                  >
                </div>

                <div class="mb-3">
                  <label class="form-label">Country</label>
                  <input 
                    type="text"
                    name="country"
                    class="form-control"
                    value="<%= listing.country %>"
                    required
                  >
                </div>
              </div>

              <div class="d-grid">
                <button 
                  class="btn text-white fw-semibold"
                  style="background-color:#FF385C;"
                >
                  Update Listing
                </button>
              </div>

            </form>

          </div>
        </div>

      </div>
    </div>
  </div>

</body>
